<!DOCTYPE html><html lang="en" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>closure | what</title><meta name="description" content="first class funtionIn computer science, a programming language is said to have first-class functions if it treats functions as first-class citizens what: This means the language supports passing funct"><meta name="keywords" content="javascript,computer science"><meta name="author" content="patrickpjx"><meta name="copyright" content="patrickpjx"><meta name="format-detection" content="telephone=no"><link rel="shortcut icon" href="/blog/img/favicon.png"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="dns-prefetch" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="https://fonts.googleapis.com" crossorigin="crossorigin"/><link rel="dns-prefetch" href="https://fonts.googleapis.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="dns-prefetch" href="//busuanzi.ibruce.info"/><meta name="twitter:card" content="summary"><meta name="twitter:title" content="closure"><meta name="twitter:description" content="first class funtionIn computer science, a programming language is said to have first-class functions if it treats functions as first-class citizens what: This means the language supports passing funct"><meta name="twitter:image" content="https://raw.githubusercontent.com/patrickpjx/i/master/img/667.jpg"><meta property="og:type" content="article"><meta property="og:title" content="closure"><meta property="og:url" content="https://github.com/patrickpjx/blog/2020/07/21/closure/"><meta property="og:site_name" content="what"><meta property="og:description" content="first class funtionIn computer science, a programming language is said to have first-class functions if it treats functions as first-class citizens what: This means the language supports passing funct"><meta property="og:image" content="https://raw.githubusercontent.com/patrickpjx/i/master/img/667.jpg"><meta property="article:published_time" content="2020-07-21T02:58:14.000Z"><meta property="article:modified_time" content="2020-07-29T06:52:05.537Z"><link rel="manifest" href="/blog/pwa/manifest.json"/><meta name="theme-color" content="#fff"/><meta name="msapplication-TileColor" content="#fff"/><link rel="apple-touch-icon" sizes="180x180" href="/blog/pwa/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/blog/pwa/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/blog/pwa/favicon-16x16.png"/><link rel="mask-icon" href="/blog/pwa/safari-pinned-tab.svg" color="#5bbad5"/><script src="https://cdn.jsdelivr.net/npm/js-cookie/dist/js.cookie.min.js"></script><script>var autoChangeMode = '1'
var t = Cookies.get("theme")
if (autoChangeMode == '1'){
  var isDarkMode = window.matchMedia("(prefers-color-scheme: dark)").matches
  var isLightMode = window.matchMedia("(prefers-color-scheme: light)").matches
  var isNotSpecified = window.matchMedia("(prefers-color-scheme: no-preference)").matches
  var hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

  if (t === undefined){
    if (isLightMode) activateLightMode()
    else if (isDarkMode) activateDarkMode()
    else if (isNotSpecified || hasNoSupport){
      console.log('You specified no preference for a color scheme or your browser does not support it. I Schedule dark mode during night time.')
      var now = new Date()
      var hour = now.getHours()
      var isNight = hour < 6 || hour >= 18
      isNight ? activateDarkMode() : activateLightMode()
  }
  } else if (t == 'light') activateLightMode()
  else activateDarkMode()

} else if (autoChangeMode == '2'){
  now = new Date();
  hour = now.getHours();
  isNight = hour < 6 || hour >= 18
  if(t === undefined) isNight? activateDarkMode() : activateLightMode()
  else if (t === 'light') activateLightMode()
  else activateDarkMode() 
} else {
  if ( t == 'dark' ) activateDarkMode()
  else if ( t == 'light') activateLightMode()
}

function activateDarkMode(){
  document.documentElement.setAttribute('data-theme', 'dark')
  if (document.querySelector('meta[name="theme-color"]') !== null){
    document.querySelector('meta[name="theme-color"]').setAttribute('content','#000')
  }
}
function activateLightMode(){
  document.documentElement.setAttribute('data-theme', 'light')
  if (document.querySelector('meta[name="theme-color"]') !== null){
  document.querySelector('meta[name="theme-color"]').setAttribute('content','#fff')
  }
}</script><link rel="stylesheet" href="/blog/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><link rel="canonical" href="https://github.com/patrickpjx/blog/2020/07/21/closure/"><link rel="prev" title="callstack" href="https://github.com/patrickpjx/blog/2020/07/29/callstack/"><link rel="next" title="webwork" href="https://github.com/patrickpjx/blog/2020/07/02/webworker/"><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Titillium+Web"><script>var GLOBAL_CONFIG = { 
  root: '/blog/',
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"cookieDomain":"https://xxx/","msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  },
  bookmark: {
    message_prev: 'Press',
    message_next: 'to bookmark this page'
  },
  runtime_unit: 'days',
  runtime: true,
  copyright: undefined,
  ClickShowText: undefined,
  medium_zoom: false,
  fancybox: true,
  Snackbar: undefined,
  baiduPush: false,
  highlightCopy: true,
  highlightLang: true,
  highlightShrink: 'false',
  isFontAwesomeV5: false,
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
  
}</script><script>var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isSidebar: true  
  }</script><noscript><style>
#page-header {
  opacity: 1
}
.justified-gallery img{
  opacity: 1
}
</style></noscript><meta name="generator" content="Hexo 4.2.0"></head><body><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" src="/blog/img/avatar.png" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/blog/archives/"><div class="headline">Articles</div><div class="length_num">11</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/blog/tags/"><div class="headline">Tags</div><div class="length_num">6</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/blog/categories/"><div class="headline">Categories</div><div class="length_num">4</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/blog/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/blog/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div></div></div><i class="fa fa-arrow-right on" id="toggle-sidebar" aria-hidden="true">     </i><div id="sidebar"><div class="sidebar-toc"><div class="sidebar-toc__title">Catalog</div><div class="sidebar-toc__progress"><span class="progress-notice">You've read</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-6"><a class="toc-link" href="#first-class-funtion"><span class="toc-number">1.</span> <span class="toc-text">first class funtion</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#lexically-scoped"><span class="toc-number">2.</span> <span class="toc-text">lexically scoped</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#funarg-problem"><span class="toc-number">3.</span> <span class="toc-text">funarg problem</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#downwards-funarg-problem"><span class="toc-number">4.</span> <span class="toc-text">downwards funarg problem</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#upwards-funarg-problem"><span class="toc-number">5.</span> <span class="toc-text">upwards funarg problem</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#closure"><span class="toc-number">6.</span> <span class="toc-text">closure</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#λ（Lambda）"><span class="toc-number">7.</span> <span class="toc-text">λ（Lambda）</span></a></li></ol></div></div></div><div id="body-wrap"><div class="post-bg" id="nav" style="background-image: url(https://raw.githubusercontent.com/patrickpjx/i/master/img/456.jpg)"><div id="page-header"><span class="pull_left" id="blog_name"><a class="blog_title" id="site-name" href="/blog/">what</a></span><span class="pull_right menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/blog/"><i class="fa-fw fa fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/blog/archives/"><i class="fa-fw fa fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/blog/tags/"><i class="fa-fw fa fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/blog/categories/"><i class="fa-fw fa fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/blog/link/"><i class="fa-fw fa fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/blog/about/"><i class="fa-fw fa fa-heart"></i><span> About</span></a></div><div class="menus_item"><a class="site-page"><i class="fa-fw fa fa-list" aria-hidden="true"></i><span> List</span><i class="fa fa-chevron-down menus-expand" aria-hidden="true"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/blog/music/"><i class="fa-fw fa fa-music"></i><span> Music</span></a></li><li><a class="site-page" href="/blog/movies/"><i class="fa-fw fa fa-film"></i><span> Movie</span></a></li></ul></div></div><span class="toggle-menu close"><a class="site-page"><i class="fa fa-bars fa-fw" aria-hidden="true"></i></a></span></span></div><div id="post-info"><div id="post-title"><div class="posttitle">closure</div></div><div id="post-meta"><div class="meta-firstline"><time class="post-meta__date"><span class="post-meta__date-created" title="Created 2020-07-21 10:58:14"><i class="fa fa-calendar" aria-hidden="true"></i> Created 2020-07-21</span><span class="post-meta__separator">|</span><span class="post-meta__date-updated" title="Updated 2020-07-29 14:52:05"><i class="fa fa-history" aria-hidden="true"></i> Updated 2020-07-29</span></time><span class="post-meta__categories"><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/blog/categories/javascript/">javascript</a></span></div><div class="meta-secondline"> </div><div class="meta-thirdline"><span class="post-meta-pv-cv"><i class="fa fa-eye post-meta__icon" aria-hidden="true"> </i><span>Post View:</span><span id="busuanzi_value_page_pv"></span></span><span class="post-meta-commentcount"></span></div></div></div></div><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><h6 id="first-class-funtion"><a href="#first-class-funtion" class="headerlink" title="first class funtion"></a>first class funtion</h6><p>In computer science, a programming language is said to have first-class functions if it treats functions as first-class citizens</p>
<p>what: This means the language supports passing functions as arguments to other functions, returning them as the values from other functions, and assigning them to variables or storing them in data structures</p>
<p>why: First-class functions are a necessity for the functional programming style, in which the use of higher-order functions is a standard practice. A simple example of a higher-ordered function is the map function, which takes, as its arguments, a function and a list, and returns the list formed by applying the function to each member of the list. For a language to support map, it must support passing a function as an argument.</p>
<h6 id="lexically-scoped"><a href="#lexically-scoped" class="headerlink" title="lexically scoped"></a>lexically scoped</h6><p>Lexical scope vs. dynamic scope</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ # bash language</span><br><span class="line">$ x&#x3D;1</span><br><span class="line">$ function g () &#123; echo $x ; x&#x3D;2 ; &#125;</span><br><span class="line">$ function f () &#123; local x&#x3D;3 ; g ; &#125;</span><br><span class="line">$ f # does this print 1, or 3?</span><br><span class="line">3</span><br><span class="line">$ echo $x # does this print 1, or 2?</span><br><span class="line">1</span><br></pre></td></tr></table></figure>

<p>Lexical scope: prints 1 and then 2<br>Dynamic scope: prints 3 and then 1</p>
<h6 id="funarg-problem"><a href="#funarg-problem" class="headerlink" title="funarg problem"></a>funarg problem</h6><p>In computer science, the funarg problem refers to the difficulty in implementing first-class functions (functions as first-class objects) in programming language implementations so as to use stack-based memory allocation of the functions</p>
<h6 id="downwards-funarg-problem"><a href="#downwards-funarg-problem" class="headerlink" title="downwards funarg problem"></a>downwards funarg problem</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">let x &#x3D; 10;</span><br><span class="line">function foo() &#123;</span><br><span class="line">  console.log(x);</span><br><span class="line">&#125;</span><br><span class="line">function bar(funArg) &#123;</span><br><span class="line">  let x &#x3D; 20;</span><br><span class="line">  funArg(); &#x2F;&#x2F; 10, 而不是20!</span><br><span class="line">&#125;</span><br><span class="line">&#x2F;&#x2F; 将 &#96;foo&#96; 作为实参传给 &#96;bar&#96;。</span><br><span class="line">bar(foo);</span><br></pre></td></tr></table></figure>

<h6 id="upwards-funarg-problem"><a href="#upwards-funarg-problem" class="headerlink" title="upwards funarg problem"></a>upwards funarg problem</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  let x &#x3D; 10;</span><br><span class="line">  &#x2F;&#x2F; 闭包，捕获&#96;foo&#96;的环境。</span><br><span class="line">  function bar() &#123;</span><br><span class="line">    return x;</span><br><span class="line">  &#125;</span><br><span class="line">  &#x2F;&#x2F; 向上funarg。</span><br><span class="line">  return bar;</span><br><span class="line">&#125;</span><br><span class="line">let x &#x3D; 20;</span><br><span class="line">&#x2F;&#x2F; 调用&#96;foo&#96;来返回&#96;bar&#96;闭包。</span><br><span class="line">let bar &#x3D; foo();</span><br><span class="line">bar(); &#x2F;&#x2F; 10，而不是20!</span><br></pre></td></tr></table></figure>

<h6 id="closure"><a href="#closure" class="headerlink" title="closure"></a>closure</h6><p>In programming languages, a closure, also lexical closure or function closure, is a technique for implementing lexically scoped name binding in a language with first-class functions</p>
<p>what: a technique<br>why: funarg problem<br>How: Unlike a plain function, a closure allows the function to access those captured variables through the closure’s copies of their values or references, even when the function is invoked outside their scope</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">function foo() &#123;</span><br><span class="line">  var a &#x3D; &#123; x: 1, y: 2 &#125;; &#x2F;&#x2F; 对象</span><br><span class="line">  var b &#x3D; 10; &#x2F;&#x2F; 基本数据类型</span><br><span class="line">  function bar(param) &#123;</span><br><span class="line">    return param+ b;</span><br><span class="line">  &#125;</span><br><span class="line">  return bar;</span><br><span class="line">&#125;</span><br><span class="line">var b &#x3D; 20;</span><br><span class="line">var func &#x3D; foo();</span><br><span class="line">console.log(func(1));</span><br></pre></td></tr></table></figure>



<h6 id="λ（Lambda）"><a href="#λ（Lambda）" class="headerlink" title="λ（Lambda）"></a>λ（Lambda）</h6><p>Constraint variable:local variables or parameters of function</p>
<p>Free variables:!Constraint variable</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">(lambda (x) (+ x 2))</span><br><span class="line"></span><br><span class="line">(  (lambda (x) (+ x 2))  7  )</span><br><span class="line"></span><br><span class="line">x&#x3D;&gt;y&#x3D;&gt;x+y</span><br><span class="line"></span><br><span class="line">(λx.(λy.y+x)2)1)</span><br></pre></td></tr></table></figure>

<p>(some interesting question : There’s always a bigger fish)</p>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">Author: </span><span class="post-copyright-info"><a href="mailto:undefined">patrickpjx</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">Link: </span><span class="post-copyright-info"><a href="https://github.com/patrickpjx/blog/2020/07/21/closure/">https://github.com/patrickpjx/blog/2020/07/21/closure/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">Copyright Notice: </span><span class="post-copyright-info">All articles in this blog are licensed under <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank" rel="noopener">CC BY-NC-SA 4.0</a> unless stating additionally.</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/blog/tags/javascript/">javascript</a><a class="post-meta__tags" href="/blog/tags/computer-science/">computer science</a></div><div class="post_share"><div class="social-share" data-image="https://raw.githubusercontent.com/patrickpjx/i/master/img/633.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css"/><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js"></script></div></div><nav class="pagination_post" id="pagination"><div class="prev-post pull_left"><a href="/blog/2020/07/29/callstack/"><img class="prev_cover" src="https://raw.githubusercontent.com/patrickpjx/i/master/img/633.jpg" onerror="onerror=null;src='/blog/img/404.jpg'"><div class="pagination-info"><div class="label">Previous Post</div><div class="prev_info">callstack</div></div></a></div><div class="next-post pull_right"><a href="/blog/2020/07/02/webworker/"><img class="next_cover" src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/blog/img/404.jpg'"><div class="pagination-info"><div class="label">Next Post</div><div class="next_info">webwork</div></div></a></div></nav><div class="relatedPosts"><div class="relatedPosts_headline"><i class="fa fa-fw fa-thumbs-up" aria-hidden="true"></i><span> Recommend</span></div><div class="relatedPosts_list"><div class="relatedPosts_item"><a href="/blog/2020/07/29/callstack/" title="callstack"><img class="relatedPosts_cover" src="https://raw.githubusercontent.com/patrickpjx/i/master/img/633.jpg"><div class="relatedPosts_main is-center"><div class="relatedPosts_date"><i class="fa fa-calendar fa-fw" aria-hidden="true"></i> 2020-07-29</div><div class="relatedPosts_title">callstack</div></div></a></div></div><div class="clear_both"></div></div></article></main><footer id="footer" data-type="color"><div id="footer-wrap"><div class="copyright">&copy;2020 By patrickpjx</div></div></footer></div><section class="rightside" id="rightside"><div id="rightside-config-hide"><i class="fa fa-book" id="readmode" title="Read Mode"></i><i class="fa fa-plus" id="font_plus" title="Increase font size"></i><i class="fa fa-minus" id="font_minus" title="Decrease font size"></i><a class="translate_chn_to_cht" id="translateLink" href="javascript:translatePage();" title="Traditional Chinese and Simplified Chinese Conversion" target="_self">繁</a><i class="darkmode fa fa-moon-o" id="darkmode" title="Dark Mode"></i></div><div id="rightside-config-show"><div id="rightside_config" title="Setting"><i class="fa fa-cog" aria-hidden="true"></i></div><i class="fa fa-list-ul close" id="mobile-toc-button" title="Table of Contents" aria-hidden="true"></i><i class="fa fa-arrow-up" id="go-up" title="Back to top" aria-hidden="true"></i></div></section><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/blog/js/utils.js"></script><script src="/blog/js/main.js"></script><script src="/blog/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@latest/instantpage.min.js" type="module"></script></body></html>